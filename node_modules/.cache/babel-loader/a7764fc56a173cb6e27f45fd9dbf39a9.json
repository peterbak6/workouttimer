{"ast":null,"code":"import _slicedToArray from\"/workspaces/workouttimer/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect,useRef}from'react';import'./App.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),seconds=_useState2[0],setSeconds=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isRunning=_useState4[0],setIsRunning=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),previousMinute=_useState6[0],setPreviousMinute=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),gongReady=_useState8[0],setGongReady=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),audioUnlocked=_useState10[0],setAudioUnlocked=_useState10[1];var timerRef=useRef(null);var gongSoundRef=useRef(null);var silentAudioRef=useRef(null);var _useState11=useState('#fafafa'),_useState12=_slicedToArray(_useState11,2),backgroundColor=_useState12[0],setBackgroundColor=_useState12[1];// Effect for updating the timer every second\nuseEffect(function(){if(isRunning){timerRef.current=setInterval(function(){setSeconds(function(prev){return prev+1;});},1000);}else if(timerRef.current){clearInterval(timerRef.current);}return function(){return clearInterval(timerRef.current);};// Cleanup\n},[isRunning]);useEffect(function(){var minutes=Math.floor(seconds/60);if(minutes>previousMinute){playGong();// Play gong when minute increases\nsetPreviousMinute(minutes);}},[seconds,previousMinute]);// Function to unlock the audio context on iOS using the silent audio clip\nvar unlockAudioContext=function unlockAudioContext(){if(!audioUnlocked){silentAudioRef.current.play().then(function(){setAudioUnlocked(true);// Unlock audio context on iOS\nsetGongReady(true);// Now gong sound can play\nplayGong();// Play gong when timer starts\n}).catch(function(error){return console.log('Silent audio playback failed:',error);});}else{setGongReady(true);// Gong can play after unlocking\nplayGong();// Play gong when timer starts\n}};var playGong=function playGong(){if(gongReady&&audioUnlocked){gongSoundRef.current.currentTime=0;gongSoundRef.current.play().catch(function(error){return console.log('Gong playback failed:',error);});}};// Function to handle starting the timer\nvar startTimer=function startTimer(){setBackgroundColor('#a6d854');// Pastel blue for running\nunlockAudioContext();setIsRunning(true);};// Function to handle stopping the timer\nvar stopTimer=function stopTimer(){setIsRunning(false);setBackgroundColor('#ffd92f');// Pastel yellow for paused\nplayGong();// Play gong when pausing\n};// Function to handle resetting the timer\nvar resetTimer=function resetTimer(){stopTimer();setSeconds(0);setPreviousMinute(0);setBackgroundColor('#fafafa');// Pastel green for idle\n};return/*#__PURE__*/_jsxs(\"div\",{className:\"timer-container\",style:{backgroundColor:backgroundColor},onClick:function onClick(){return isRunning?stopTimer():startTimer();},onDoubleClick:resetTimer,children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\".concat(String(Math.floor(seconds/60)).padStart(2,'0'),\":\").concat(String(seconds%60).padStart(2,'0'))}),/*#__PURE__*/_jsx(\"audio\",{ref:silentAudioRef,src:\"/silent.mp3\",preload:\"auto\"}),/*#__PURE__*/_jsx(\"audio\",{ref:gongSoundRef,src:\"/gong.mp3\",preload:\"auto\"})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useRef","App","seconds","setSeconds","isRunning","setIsRunning","previousMinute","setPreviousMinute","gongReady","setGongReady","audioUnlocked","setAudioUnlocked","timerRef","gongSoundRef","silentAudioRef","backgroundColor","setBackgroundColor","current","setInterval","prev","clearInterval","minutes","Math","floor","playGong","unlockAudioContext","play","then","catch","error","console","log","currentTime","startTimer","stopTimer","resetTimer","String","padStart"],"sources":["/workspaces/workouttimer/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport './App.css';\n\nfunction App() {\n  const [seconds, setSeconds] = useState(0);\n  const [isRunning, setIsRunning] = useState(false);\n  const [previousMinute, setPreviousMinute] = useState(0);\n  const [gongReady, setGongReady] = useState(false);\n  const [audioUnlocked, setAudioUnlocked] = useState(false);\n  const timerRef = useRef(null);\n  const gongSoundRef = useRef(null);\n  const silentAudioRef = useRef(null);\n  const [backgroundColor, setBackgroundColor] = useState('#fafafa');\n\n  // Effect for updating the timer every second\n  useEffect(() => {\n    if (isRunning) {\n      timerRef.current = setInterval(() => {\n        setSeconds((prev) => prev + 1);\n      }, 1000);\n    } else if (timerRef.current) {\n      clearInterval(timerRef.current);\n    }\n    return () => clearInterval(timerRef.current); // Cleanup\n  }, [isRunning]);\n\n  useEffect(() => {\n    const minutes = Math.floor(seconds / 60);\n    if (minutes > previousMinute) {\n      playGong(); // Play gong when minute increases\n      setPreviousMinute(minutes);\n    }\n  }, [seconds, previousMinute]);\n\n  // Function to unlock the audio context on iOS using the silent audio clip\n  const unlockAudioContext = () => {\n    if (!audioUnlocked) {\n      silentAudioRef.current.play().then(() => {\n        setAudioUnlocked(true); // Unlock audio context on iOS\n        setGongReady(true); // Now gong sound can play\n        playGong(); // Play gong when timer starts\n      }).catch((error) => console.log('Silent audio playback failed:', error));\n    } else {\n      setGongReady(true); // Gong can play after unlocking\n      playGong(); // Play gong when timer starts\n    }\n  };\n\n  const playGong = () => {\n    if (gongReady && audioUnlocked) {\n      gongSoundRef.current.currentTime = 0;\n      gongSoundRef.current.play().catch((error) => console.log('Gong playback failed:', error));\n    }\n  };\n\n  // Function to handle starting the timer\n  const startTimer = () => {\n    setBackgroundColor('#a6d854'); // Pastel blue for running\n    unlockAudioContext();\n    setIsRunning(true);\n  };\n\n  // Function to handle stopping the timer\n  const stopTimer = () => {\n    setIsRunning(false);\n    setBackgroundColor('#ffd92f'); // Pastel yellow for paused\n    playGong(); // Play gong when pausing\n  };\n\n  // Function to handle resetting the timer\n  const resetTimer = () => {\n    stopTimer();\n    setSeconds(0);\n    setPreviousMinute(0);\n    setBackgroundColor('#fafafa'); // Pastel green for idle\n  };\n\n  return (\n    <div className=\"timer-container\" style={{ backgroundColor }} \n      onClick={() => (isRunning ? stopTimer() : startTimer())} \n      onDoubleClick={resetTimer}>\n      <h1>{`${String(Math.floor(seconds / 60)).padStart(2, '0')}:${String(seconds % 60).padStart(2, '0')}`}</h1>\n\n      {/* Silent audio for iOS audio context unlock */}\n      <audio ref={silentAudioRef} src=\"/silent.mp3\" preload=\"auto\"></audio>\n\n      {/* Gong sound */}\n      <audio ref={gongSoundRef} src=\"/gong.mp3\" preload=\"auto\"></audio>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}